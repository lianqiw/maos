<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<title>MAOS: Introduction</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen_extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../maos.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">MAOS
   </div>
   <div id="projectbrief">Multithreaded Adaptive Optics Simulator</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('da/d9f/page10_intro.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Introduction</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The Multithreaded Adaptive Optics Simulator (MAOS) started as a re-implementation in C of the algorithms in the original MATLAB based linear adaptive optics simulator (LAOS), which suffers performance and multi-threading limitations. The goal is to create an efficient time domain general purpose adaptive optics simulator to help the development of adaptive optics systems, particularly advanced, very high order systems for TMT and other ELTs. MAOS now is fairly feature complete in modeling astronomical adaptive optics systems such as, multi-conjugate AO (MCAO), laser tomography AO (LTAO), ground layer AO (GLAO), multi-object AO (MOAO) and Pyramid based classic AO.</p>
<p>Simulations are configured through configuration files and command line options, which are checked for any apparent errors or conflicts. The configuration files are very human readable and easy to maintain. Default parameters are maintained in the default configuration files and only parameters that need to be overridden need to be specified by the end user.</p>
<p>Atmospheric turbulence is represented as one or multiple discrete optical path difference (OPD) screen(s) at different altitudes that evolve according to frozen flow with given wind velocities. The turbulence strength \(r_0\) can also vary with time. The turbulence is sensed by one or multiple natural guide star (NGS) or laser guide star (LGS) Shack-Hartmann wavefront sensor(s) (WFS). <br  />
</p>
<p>The telescope aperture is modeled with a gray pixel amplitude map that can simulate segmented primary mirrors and secondary mirror support vignetting. Aberration of the telescope or instrument optics are modeled as static OPD maps with various conjugation. Non-common path aberrations that originate from the WFS or science optics are handled by automatically biasing the WFS measurements.</p>
<p>The wavefront sensors (WFS) can be simulated as idealized wavefront gradient sensors, best Zernike fit tilt sensors, or physical optic WFS using user specified detector pixel characteristics and center of gravity or matched filter pixel processing algorithm. Pyramid WFS is also implemented for the NGS with modulation and optical gain optimization. The laser guide star wavefront sensing model includes the impact of guide star elongation for a specified sodium layer profile and an optional polar coordinate CCD. Automatic sub-aperture or optical gain optimization can be done by dithering the spot in a circular motion and compare the input and measured motion.</p>
<p>One or multiple deformable mirrors are simulated with grid of actuators that couple together with a predefined coupling coefficient. The actuator hysteresis, stroke limit, inter-actuator stroke limit, stuck or floating dead actuators can also be modeled. Both zonal and modal control are supported.</p>
<p>The tomographic wavefront reconstruction estimates the turbulence in several different heights from the pseudo open loop gradients (formed by adding the deformation mirror (DM) correction back to the gradients) measured by the WFS, using a computationally efficient implementation of a minimum variance reconstruction algorithm as described in [Ellerbroek, 2002]. These reconstructed turbulence screens are then fit to the actuators on one or several deformable mirrors (DMs) to achieve best possible correction over a specified field of view (FoV). For LGS based MCAO with separate low order WFS controlling tip/tilt and plate scale, so called <code>split tomography</code> control algorithm is used that reconstructs the low order modes separately from the high order reconstruction with additional sanitization to decouple the two. For classic AO, least squares control is also implemented. A simple integrator with gain update is used to control the DM. For low order control, an LQG based Kalman filter is also implemented.</p>
<p>Performance evaluation is done in terms of RMS wavefront error, Strehl ratio, and/or point spread functions (PSFs) at a few science objects in the target FoV, which might be different from the FoV used for the DM fitting step.</p>
<p>Various knobs and switches are implemented to probe the contributions of various effects, such as DM fitting error, tomography error, telescope aberration, DM hysteresis error, failed actuators, etc. These simulations are used to optimize system parameters and/or build the error budget.</p>
<p>This software is written in the C language (revision 99), with external dependent libraries of FFTW version 3 (www.fftw.org), blas/lapack (www.netlib.org/lapack/, Openblas, or Intel MKL), Cholmod (www.cise.ufl.edu/research/sparse/SuiteSparse/ for Cholesky factorization), and optionally CUDA SDK (for GPU acceleration). Automake, autoconf, libtool and make are needed to configure the code and compile. It also requires POSIX compliant C library for a few system calls.</p>
<p>A C99 compliant compiler is required to compile the code. The cost has been tested with GNU GCC, Intel ICC, and CLANG. For machines with Intel CPUs, the code generally runs faster when compiled with ICC and linked with MKL. Nvidia CUDA SDK is needed to compile the optional CUDA code which runs in Nvidia GPUs (&gt;2.0 compute capability).</p>
<p>This software also contains two optionally compiled graphical executables (drawdaemon, monitor) for plotting and job monitoring (jobs can be monitored on several different machines). These two executable require GTK+.</p>
<p>The multi-threading is achieved using POSIX Threads (no MPI is implemented) or OpenMP. This parallelism works fairly well in multi-core, shared memory machines. For example, in a recently purchased desktop as of this writing with Intel Core i5 quad-core processor, the software (configured in a NFIRAOS split tomography mode with physical optics LGS and geometric best fit Zernike tilt NGS), can run at 7 seconds per simulation time step with 1 thread and ~1 seconds per time step with 8 threads. The scaling with number of cores is fairly good. Each time step takes only ~0.06 seconds on a 8x GTX 580 or dual RTX 2080 Ti GPU setup (in single precision mode). The memory consumption in the NFIRAOS baseline case is about 2 GB.</p>
<p>The code contains a few directories. The <code>sys</code> directory contains the lower levels libraries that often deals with the system for input/output, and process management. The <code>math</code> directory contains mathematical data structures and associated functions. The <code>lib</code> directory contains adaptive optics related data structures and functions. The <code>maos</code> directory contains the end to end adaptive optics simulation implementation. The <code>skyc</code> is contains routines for sky coverage postprocessing that takes <code>maos</code> results as input. The <code>scripts</code> folder contains useful Python, Matlab, and IDL routines that can be used to read/write the simulation results or call <code>maos</code> internal routines.</p>
<p>Please see <a class="el" href="../../d3/d4c/page20_compile.html">Compile the Code</a> on how to compile and use MAOS. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->

   </ul>
 </div>
</body>
</html>
