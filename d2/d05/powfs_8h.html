<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<title>MAOS: maos/powfs.h File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen_extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../maos.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">MAOS
   </div>
   <div id="projectbrief">Multithreaded Adaptive Optics Simulator</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d2/d05/powfs_8h.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">powfs.h File Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ac63a28d275395aa7dc0fd53e99348971" id="r_ac63a28d275395aa7dc0fd53e99348971"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/d94/maos_2types_8h.html#da/dcf/structpowfs__t">powfs_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d05/powfs_8h.html#ac63a28d275395aa7dc0fd53e99348971">setup_powfs_init</a> (<a class="el" href="../../d0/d44/class_num_array.html">const</a> <a class="el" href="../../d4/d38/parms_8h.html#d4/d51/structparms__t">parms_t</a> *parms, <a class="el" href="../../df/def/type_8h.html#d6/da3/structmap__t">map_t</a> *aper)</td></tr>
<tr class="separator:ac63a28d275395aa7dc0fd53e99348971"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a364f6c7df7378dad1a6bc6c2b44b16" id="r_a9a364f6c7df7378dad1a6bc6c2b44b16"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d44/class_num_array.html">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d05/powfs_8h.html#a9a364f6c7df7378dad1a6bc6c2b44b16">setup_powfs_misreg_tel</a> (<a class="el" href="../../d6/d94/maos_2types_8h.html#da/dcf/structpowfs__t">powfs_t</a> *powfs, <a class="el" href="../../d0/d44/class_num_array.html">const</a> <a class="el" href="../../d4/d38/parms_8h.html#d4/d51/structparms__t">parms_t</a> *parms, int ipowfs)</td></tr>
<tr class="separator:a9a364f6c7df7378dad1a6bc6c2b44b16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7d95dd96dc3e716760129e39d9c26e7" id="r_ad7d95dd96dc3e716760129e39d9c26e7"><td class="memItemLeft" align="right" valign="top"><a id="ad7d95dd96dc3e716760129e39d9c26e7" name="ad7d95dd96dc3e716760129e39d9c26e7"></a>
<a class="el" href="../../d0/d44/class_num_array.html">void</a>&#160;</td><td class="memItemRight" valign="bottom"><b>setup_powfs_amp</b> (<a class="el" href="../../d6/d94/maos_2types_8h.html#da/dcf/structpowfs__t">powfs_t</a> *powfs, <a class="el" href="../../d0/d44/class_num_array.html">const</a> <a class="el" href="../../d4/d38/parms_8h.html#d4/d51/structparms__t">parms_t</a> *parms, <a class="el" href="../../d0/d44/class_num_array.html">const</a> <a class="el" href="../../df/def/type_8h.html#d6/da3/structmap__t">map_t</a> *aper, <a class="el" href="../../d0/d44/class_num_array.html">const</a> <a class="el" href="../../d3/d27/structdmat.html">dmat</a> *misreg, int ipowfs)</td></tr>
<tr class="separator:ad7d95dd96dc3e716760129e39d9c26e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab377315d3eaa9b9be9a3cdfadfa24b36" id="r_ab377315d3eaa9b9be9a3cdfadfa24b36"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d44/class_num_array.html">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d05/powfs_8h.html#ab377315d3eaa9b9be9a3cdfadfa24b36">setup_powfs_misreg_dm</a> (<a class="el" href="../../d6/d94/maos_2types_8h.html#da/dcf/structpowfs__t">powfs_t</a> *powfs, <a class="el" href="../../d0/d44/class_num_array.html">const</a> <a class="el" href="../../d4/d38/parms_8h.html#d4/d51/structparms__t">parms_t</a> *parms, int ipowfs)</td></tr>
<tr class="separator:ab377315d3eaa9b9be9a3cdfadfa24b36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac94d189fbc564ff0a88e7740c23cd3ad" id="r_ac94d189fbc564ff0a88e7740c23cd3ad"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d44/class_num_array.html">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d05/powfs_8h.html#ac94d189fbc564ff0a88e7740c23cd3ad">setup_shwfs_phy</a> (<a class="el" href="../../d0/d44/class_num_array.html">const</a> <a class="el" href="../../d4/d38/parms_8h.html#d4/d51/structparms__t">parms_t</a> *parms, <a class="el" href="../../d6/d94/maos_2types_8h.html#da/dcf/structpowfs__t">powfs_t</a> *powfs)</td></tr>
<tr class="separator:ac94d189fbc564ff0a88e7740c23cd3ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36b1526a9936b7bfd6256e5abbfe94a8" id="r_a36b1526a9936b7bfd6256e5abbfe94a8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d44/class_num_array.html">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d05/powfs_8h.html#a36b1526a9936b7bfd6256e5abbfe94a8">setup_powfs_neasim</a> (<a class="el" href="../../d0/d44/class_num_array.html">const</a> <a class="el" href="../../d4/d38/parms_8h.html#d4/d51/structparms__t">parms_t</a> *parms, <a class="el" href="../../d6/d94/maos_2types_8h.html#da/dcf/structpowfs__t">powfs_t</a> *powfs)</td></tr>
<tr class="memdesc:a36b1526a9936b7bfd6256e5abbfe94a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the up powfs neasim for simulations.  <br /></td></tr>
<tr class="separator:a36b1526a9936b7bfd6256e5abbfe94a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33bf8889280bcb05fb321b5397ccb49e" id="r_a33bf8889280bcb05fb321b5397ccb49e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d44/class_num_array.html">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d05/powfs_8h.html#a33bf8889280bcb05fb321b5397ccb49e">setup_powfs_calib</a> (<a class="el" href="../../d0/d44/class_num_array.html">const</a> <a class="el" href="../../d4/d38/parms_8h.html#d4/d51/structparms__t">parms_t</a> *parms, <a class="el" href="../../d6/d94/maos_2types_8h.html#da/dcf/structpowfs__t">powfs_t</a> *powfs)</td></tr>
<tr class="separator:a33bf8889280bcb05fb321b5397ccb49e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26a75b0436e21b8fca94ac004676e984" id="r_a26a75b0436e21b8fca94ac004676e984"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d44/class_num_array.html">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d05/powfs_8h.html#a26a75b0436e21b8fca94ac004676e984">free_powfs_unused</a> (<a class="el" href="../../d0/d44/class_num_array.html">const</a> <a class="el" href="../../d4/d38/parms_8h.html#d4/d51/structparms__t">parms_t</a> *parms, <a class="el" href="../../d6/d94/maos_2types_8h.html#da/dcf/structpowfs__t">powfs_t</a> *powfs)</td></tr>
<tr class="separator:a26a75b0436e21b8fca94ac004676e984"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a9c34e6fc651433c73473e0e039dc63" id="r_a1a9c34e6fc651433c73473e0e039dc63"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d44/class_num_array.html">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d05/powfs_8h.html#a1a9c34e6fc651433c73473e0e039dc63">free_powfs</a> (<a class="el" href="../../d0/d44/class_num_array.html">const</a> <a class="el" href="../../d4/d38/parms_8h.html#d4/d51/structparms__t">parms_t</a> *parms, <a class="el" href="../../d6/d94/maos_2types_8h.html#da/dcf/structpowfs__t">powfs_t</a> *powfs)</td></tr>
<tr class="separator:a1a9c34e6fc651433c73473e0e039dc63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e3f5ff1d656e52f5f1c2aa2f8db9c94" id="r_a9e3f5ff1d656e52f5f1c2aa2f8db9c94"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d44/class_num_array.html">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d05/powfs_8h.html#a9e3f5ff1d656e52f5f1c2aa2f8db9c94">setup_shwfs_etf</a> (<a class="el" href="../../d6/d94/maos_2types_8h.html#da/dcf/structpowfs__t">powfs_t</a> *powfs, <a class="el" href="../../d0/d44/class_num_array.html">const</a> <a class="el" href="../../d4/d38/parms_8h.html#d4/d51/structparms__t">parms_t</a> *parms, int ipowfs, int mode, int icol, real <a class="el" href="../../d0/d44/class_num_array.html">deltah</a>, real <a class="el" href="../../d0/d44/class_num_array.html">thresh</a>)</td></tr>
<tr class="separator:a9e3f5ff1d656e52f5f1c2aa2f8db9c94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2d609d5e539eeb17e1a57f6365a1c4f" id="r_ac2d609d5e539eeb17e1a57f6365a1c4f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d44/class_num_array.html">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d05/powfs_8h.html#ac2d609d5e539eeb17e1a57f6365a1c4f">wfspupmask</a> (<a class="el" href="../../d0/d44/class_num_array.html">const</a> <a class="el" href="../../d4/d38/parms_8h.html#d4/d51/structparms__t">parms_t</a> *parms, <a class="el" href="../../df/def/type_8h.html#da/ddc/structloc__t">loc_t</a> *loc, <a class="el" href="../../d3/d27/structdmat.html">dmat</a> *amp, int iwfs)</td></tr>
<tr class="separator:ac2d609d5e539eeb17e1a57f6365a1c4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d2a2ad6e2a811ad183dee53eaeb3ef9" id="r_a2d2a2ad6e2a811ad183dee53eaeb3ef9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d44/class_num_array.html">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d05/powfs_8h.html#a2d2a2ad6e2a811ad183dee53eaeb3ef9">setup_pywfs</a> (<a class="el" href="../../d0/d44/class_num_array.html">const</a> <a class="el" href="../../d9/d19/pywfs_8h.html#d0/d1d/structpywfs__cfg__t">pywfs_cfg_t</a> *pycfg, <a class="el" href="../../d6/d94/maos_2types_8h.html#da/dcf/structpowfs__t">powfs_t</a> *powfs, <a class="el" href="../../d0/d44/class_num_array.html">const</a> <a class="el" href="../../d4/d38/parms_8h.html#d4/d51/structparms__t">parms_t</a> *parms, <a class="el" href="../../df/def/type_8h.html#d6/da3/structmap__t">map_t</a> *aper, int ipowfs)</td></tr>
<tr class="separator:a2d2a2ad6e2a811ad183dee53eaeb3ef9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Setting up WFS geometry. like the subaperture location, subaperture grid points, physical optics detection transfer function, LGS elongation transfer function, etc.</p>
<dl class="todo"><dt><b><a class="el" href="../../dd/da0/todo.html#_todo000007">Todo:</a></b></dt><dd>isolate DTF, ETF, routines, make then generic interface and relocate to the lib folder.</dd></dl>
<p>Do not use sparse interpolation to replace ray tracing for fine sampled destination grid, especially cubic splines. The interpolation marix takes too much space.</p>
<p>TODO: This routine and <a class="el" href="../../d6/d94/maos_2types_8h.html#da/dcf/structpowfs__t">powfs_t</a> should only contain information about the simulation, not about any model used during reconstruction (RTC) to avoid leaking information from the "real world (simulation)" to our knowledge (RTC). </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ac63a28d275395aa7dc0fd53e99348971" name="ac63a28d275395aa7dc0fd53e99348971"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac63a28d275395aa7dc0fd53e99348971">&#9670;&#160;</a></span>setup_powfs_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d6/d94/maos_2types_8h.html#da/dcf/structpowfs__t">powfs_t</a> * setup_powfs_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/d44/class_num_array.html">const</a> <a class="el" href="../../d4/d38/parms_8h.html#d4/d51/structparms__t">parms_t</a> *&#160;</td>
          <td class="paramname"><em>parms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/def/type_8h.html#d6/da3/structmap__t">map_t</a> *&#160;</td>
          <td class="paramname"><em>aper</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Setup the powfs struct based on parms and aper. Everything about wfs are setup here. </p>

</div>
</div>
<a id="a9a364f6c7df7378dad1a6bc6c2b44b16" name="a9a364f6c7df7378dad1a6bc6c2b44b16"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a364f6c7df7378dad1a6bc6c2b44b16">&#9670;&#160;</a></span>setup_powfs_misreg_tel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d44/class_num_array.html">void</a> setup_powfs_misreg_tel </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/d94/maos_2types_8h.html#da/dcf/structpowfs__t">powfs_t</a> *&#160;</td>
          <td class="paramname"><em>powfs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d44/class_num_array.html">const</a> <a class="el" href="../../d4/d38/parms_8h.html#d4/d51/structparms__t">parms_t</a> *&#160;</td>
          <td class="paramname"><em>parms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ipowfs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Setup telescope to WFS pupil misregistration.</p>
<p>It is tricky to implement the misregistration of the deformable mirror and the WFS.</p>
<p>Misregistration of the deformable mirror.</p>
<p>Denote the grid of actuators as saloc, and with misregistration, it becomes salocm.</p>
<ul>
<li>We should use saloc for DM fitting and pseudo open loop gradient computations because we are not aware of the misregistration.</li>
<li>We should use salocm for raytracing to WFS and performance evaluation because this is what happens in the system, no matter whether we know the misregistration or not.</li>
</ul>
<p>Misregistration of the WFS.</p>
<p>Denote the grid of the WFS entry pupil as loc, and with misregistration, it becomes locm. Project the telescope amplitude map onto loc, we get amp, which is what we know. Project the telescope amplitude map onto locm, we get ampm, which is what happens but we don't know.</p>
<ul>
<li>We should use loc and amp to compute the reconstructor.</li>
<li>We should use locm and ampm for tracing to WFS and performance evaluation.</li>
<li>We should use loc and ampm for matched filter, averaging gradient, or zernike tip/tilt operator computation, since this is the process that happens in the system, and the matched filter is updated through dithering to the true amplitude map. We use loc because it is our model within the WFS.</li>
<li>We should use ptsm-&gt;area (real area) to select subapertures for use in reconstruction, because in real system, the subapertures are selected by their illumination level, and is affected by the real amplitude. </li>
</ul>

</div>
</div>
<a id="ab377315d3eaa9b9be9a3cdfadfa24b36" name="ab377315d3eaa9b9be9a3cdfadfa24b36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab377315d3eaa9b9be9a3cdfadfa24b36">&#9670;&#160;</a></span>setup_powfs_misreg_dm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d44/class_num_array.html">void</a> setup_powfs_misreg_dm </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/d94/maos_2types_8h.html#da/dcf/structpowfs__t">powfs_t</a> *&#160;</td>
          <td class="paramname"><em>powfs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d44/class_num_array.html">const</a> <a class="el" href="../../d4/d38/parms_8h.html#d4/d51/structparms__t">parms_t</a> *&#160;</td>
          <td class="paramname"><em>parms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ipowfs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>setup DM to WFS misregistration. </p>

</div>
</div>
<a id="ac94d189fbc564ff0a88e7740c23cd3ad" name="ac94d189fbc564ff0a88e7740c23cd3ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac94d189fbc564ff0a88e7740c23cd3ad">&#9670;&#160;</a></span>setup_shwfs_phy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d44/class_num_array.html">void</a> setup_shwfs_phy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/d44/class_num_array.html">const</a> <a class="el" href="../../d4/d38/parms_8h.html#d4/d51/structparms__t">parms_t</a> *&#160;</td>
          <td class="paramname"><em>parms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d94/maos_2types_8h.html#da/dcf/structpowfs__t">powfs_t</a> *&#160;</td>
          <td class="paramname"><em>powfs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Setup physical optics parameters for SHWFS, such as DTF, ETF, LLT, pixel processing. </p>

</div>
</div>
<a id="a36b1526a9936b7bfd6256e5abbfe94a8" name="a36b1526a9936b7bfd6256e5abbfe94a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36b1526a9936b7bfd6256e5abbfe94a8">&#9670;&#160;</a></span>setup_powfs_neasim()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d44/class_num_array.html">void</a> setup_powfs_neasim </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/d44/class_num_array.html">const</a> <a class="el" href="../../d4/d38/parms_8h.html#d4/d51/structparms__t">parms_t</a> *&#160;</td>
          <td class="paramname"><em>parms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d94/maos_2types_8h.html#da/dcf/structpowfs__t">powfs_t</a> *&#160;</td>
          <td class="paramname"><em>powfs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the up powfs neasim for simulations. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">parms</td><td></td></tr>
    <tr><td class="paramname">powfs</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a33bf8889280bcb05fb321b5397ccb49e" name="a33bf8889280bcb05fb321b5397ccb49e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33bf8889280bcb05fb321b5397ccb49e">&#9670;&#160;</a></span>setup_powfs_calib()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d44/class_num_array.html">void</a> setup_powfs_calib </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/d44/class_num_array.html">const</a> <a class="el" href="../../d4/d38/parms_8h.html#d4/d51/structparms__t">parms_t</a> *&#160;</td>
          <td class="paramname"><em>parms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d94/maos_2types_8h.html#da/dcf/structpowfs__t">powfs_t</a> *&#160;</td>
          <td class="paramname"><em>powfs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Setup gradient offset for calibration. opdadd is the wavefront aberration in WFS due to optics, without DM correction. opdbias is the wavefront aberration in WFS after DM system flat is applied. </p>

</div>
</div>
<a id="a26a75b0436e21b8fca94ac004676e984" name="a26a75b0436e21b8fca94ac004676e984"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26a75b0436e21b8fca94ac004676e984">&#9670;&#160;</a></span>free_powfs_unused()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d44/class_num_array.html">void</a> free_powfs_unused </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/d44/class_num_array.html">const</a> <a class="el" href="../../d4/d38/parms_8h.html#d4/d51/structparms__t">parms_t</a> *&#160;</td>
          <td class="paramname"><em>parms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d94/maos_2types_8h.html#da/dcf/structpowfs__t">powfs_t</a> *&#160;</td>
          <td class="paramname"><em>powfs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>free unused parameters before simulation starts </p>

</div>
</div>
<a id="a1a9c34e6fc651433c73473e0e039dc63" name="a1a9c34e6fc651433c73473e0e039dc63"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a9c34e6fc651433c73473e0e039dc63">&#9670;&#160;</a></span>free_powfs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d44/class_num_array.html">void</a> free_powfs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/d44/class_num_array.html">const</a> <a class="el" href="../../d4/d38/parms_8h.html#d4/d51/structparms__t">parms_t</a> *&#160;</td>
          <td class="paramname"><em>parms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d94/maos_2types_8h.html#da/dcf/structpowfs__t">powfs_t</a> *&#160;</td>
          <td class="paramname"><em>powfs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Free all parameters of powfs at the end of simulation. </p>

</div>
</div>
<a id="a9e3f5ff1d656e52f5f1c2aa2f8db9c94" name="a9e3f5ff1d656e52f5f1c2aa2f8db9c94"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e3f5ff1d656e52f5f1c2aa2f8db9c94">&#9670;&#160;</a></span>setup_shwfs_etf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d44/class_num_array.html">void</a> setup_shwfs_etf </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/d94/maos_2types_8h.html#da/dcf/structpowfs__t">powfs_t</a> *&#160;</td>
          <td class="paramname"><em>powfs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d44/class_num_array.html">const</a> <a class="el" href="../../d4/d38/parms_8h.html#d4/d51/structparms__t">parms_t</a> *&#160;</td>
          <td class="paramname"><em>parms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ipowfs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>icol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>deltah</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>thresh</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute Elongation Transfer function.</p><ul>
<li>mode=0: for preparation of matched filter.</li>
<li>mode=1: for simulation.</li>
<li>mode=2: for simulation, next profile (linear interpolation.) </li>
</ul>

</div>
</div>
<a id="ac2d609d5e539eeb17e1a57f6365a1c4f" name="ac2d609d5e539eeb17e1a57f6365a1c4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2d609d5e539eeb17e1a57f6365a1c4f">&#9670;&#160;</a></span>wfspupmask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d44/class_num_array.html">void</a> wfspupmask </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/d44/class_num_array.html">const</a> <a class="el" href="../../d4/d38/parms_8h.html#d4/d51/structparms__t">parms_t</a> *&#160;</td>
          <td class="paramname"><em>parms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/def/type_8h.html#da/ddc/structloc__t">loc_t</a> *&#160;</td>
          <td class="paramname"><em>loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d3/d27/structdmat.html">dmat</a> *&#160;</td>
          <td class="paramname"><em>amp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iwfs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates WFS pupil mask that is composed of the meta pupil of high order WFS at height hmax*0.7. Not used. </p>

</div>
</div>
<a id="a2d2a2ad6e2a811ad183dee53eaeb3ef9" name="a2d2a2ad6e2a811ad183dee53eaeb3ef9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d2a2ad6e2a811ad183dee53eaeb3ef9">&#9670;&#160;</a></span>setup_pywfs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d44/class_num_array.html">void</a> setup_pywfs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/d44/class_num_array.html">const</a> <a class="el" href="../../d9/d19/pywfs_8h.html#d0/d1d/structpywfs__cfg__t">pywfs_cfg_t</a> *&#160;</td>
          <td class="paramname"><em>pycfg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d94/maos_2types_8h.html#da/dcf/structpowfs__t">powfs_t</a> *&#160;</td>
          <td class="paramname"><em>powfs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d44/class_num_array.html">const</a> <a class="el" href="../../d4/d38/parms_8h.html#d4/d51/structparms__t">parms_t</a> *&#160;</td>
          <td class="paramname"><em>parms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/def/type_8h.html#d6/da3/structmap__t">map_t</a> *&#160;</td>
          <td class="paramname"><em>aper</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ipowfs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Setup pyramid WFS based on configuration.</p>
<p>Todo: In order to move the implementation to lib/ the following changes are needed</p><ul>
<li>Generate loc/amp externally and supply here.</li>
<li>Handle misregistration externally. Different misregisration is used in simulation and reconstruction.</li>
<li>... </li>
</ul>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->

   </ul>
 </div>
</body>
</html>
