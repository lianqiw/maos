<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>MAOS: maos/recon_utils.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="maos.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">MAOS
   </div>
   <div id="projectbrief">Multithreaded Adaptive Optics Simulator</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('recon__utils_8h.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">recon_utils.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab783a16cfb484ce0c36371e3161e1689"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recon__utils_8h.html#ab783a16cfb484ce0c36371e3161e1689">apply_L2</a> (<a class="el" href="type_8h.html#structdcell">dcell</a> **xout, const <a class="el" href="type_8h.html#structdspcell">dspcell</a> *L2, const <a class="el" href="type_8h.html#structdcell">dcell</a> *xin, real alpha)</td></tr>
<tr class="separator:ab783a16cfb484ce0c36371e3161e1689"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abfaa311b9be11571120dff4f870dca5e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recon__utils_8h.html#abfaa311b9be11571120dff4f870dca5e">apply_invpsd</a> (<a class="el" href="type_8h.html#structdcell">dcell</a> **xout, const void *extra, const <a class="el" href="type_8h.html#structdcell">dcell</a> *xin, real alpha, int xb, int yb)</td></tr>
<tr class="separator:abfaa311b9be11571120dff4f870dca5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a6ad264e91cb4ab88c057011ca80fd9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recon__utils_8h.html#a6a6ad264e91cb4ab88c057011ca80fd9">apply_fractal</a> (<a class="el" href="type_8h.html#structdcell">dcell</a> **xout, const void *extra, const <a class="el" href="type_8h.html#structdcell">dcell</a> *xin, real alpha, int xb, int yb)</td></tr>
<tr class="separator:a6a6ad264e91cb4ab88c057011ca80fd9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2a1d9e1979e85bc3f9fc9fc7983101c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recon__utils_8h.html#aa2a1d9e1979e85bc3f9fc9fc7983101c">remove_mode</a> (<a class="el" href="type_8h.html#structdcell">dcell</a> *x, const <a class="el" href="type_8h.html#structdcell">dcell</a> *M, const <a class="el" href="type_8h.html#structdcell">dcell</a> *PM)</td></tr>
<tr class="memdesc:aa2a1d9e1979e85bc3f9fc9fc7983101c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove projection x = x - M * (PM * x)  <a href="#aa2a1d9e1979e85bc3f9fc9fc7983101c">More...</a><br /></td></tr>
<tr class="separator:aa2a1d9e1979e85bc3f9fc9fc7983101c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29875eda5bf6485bb6b3b5628da3e361"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recon__utils_8h.html#a29875eda5bf6485bb6b3b5628da3e361">applyW</a> (<a class="el" href="type_8h.html#structdcell">dcell</a> *xin, const <a class="el" href="type_8h.html#structdsp">dsp</a> *W0, const <a class="el" href="structdmat.html">dmat</a> *W1, const real *wt)</td></tr>
<tr class="separator:a29875eda5bf6485bb6b3b5628da3e361"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2bca0565f72973497ae8d589a8be63d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="type_8h.html#structdcell">dcell</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recon__utils_8h.html#ac2bca0565f72973497ae8d589a8be63d">calcWmcc</a> (const <a class="el" href="type_8h.html#structdcell">dcell</a> *A, const <a class="el" href="type_8h.html#structdcell">dcell</a> *B, const <a class="el" href="type_8h.html#structdsp">dsp</a> *W0, const <a class="el" href="structdmat.html">dmat</a> *W1, const <a class="el" href="structdmat.html">dmat</a> *wt)</td></tr>
<tr class="separator:ac2bca0565f72973497ae8d589a8be63d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f47ff139af79e1d954e29492a3f6436"><td class="memItemLeft" align="right" valign="top"><a class="el" href="type_8h.html#structdsp">dsp</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recon__utils_8h.html#a2f47ff139af79e1d954e29492a3f6436">nea2sp</a> (<a class="el" href="structdmat.html">dmat</a> *nea, int ll, int ur, int ng)</td></tr>
<tr class="separator:a2f47ff139af79e1d954e29492a3f6436"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7574376a632a9ecd690f182327ece31a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recon__utils_8h.html#a7574376a632a9ecd690f182327ece31a">nea_chol</a> (<a class="el" href="structdmat.html">dmat</a> **pout, const <a class="el" href="structdmat.html">dmat</a> *in, int ng)</td></tr>
<tr class="separator:a7574376a632a9ecd690f182327ece31a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30787abb7d5ba357803cabb24c2d26ff"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recon__utils_8h.html#a30787abb7d5ba357803cabb24c2d26ff">nea_inv</a> (<a class="el" href="structdmat.html">dmat</a> **pout, const <a class="el" href="structdmat.html">dmat</a> *in, int ng, real scale)</td></tr>
<tr class="separator:a30787abb7d5ba357803cabb24c2d26ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5e4f268e97c577eb4c5688ec0d595a0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recon__utils_8h.html#ad5e4f268e97c577eb4c5688ec0d595a0">nea_mm</a> (<a class="el" href="structdmat.html">dmat</a> **pout, const <a class="el" href="structdmat.html">dmat</a> *in, int ng)</td></tr>
<tr class="separator:ad5e4f268e97c577eb4c5688ec0d595a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af39118a3522ee175ace7951a59d82755"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recon__utils_8h.html#af39118a3522ee175ace7951a59d82755">nea_check</a> (<a class="el" href="structdmat.html">dmat</a> *nea, int nsa, int ng)</td></tr>
<tr class="separator:af39118a3522ee175ace7951a59d82755"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f4664a8c57cd234087fd70daf7ff7b0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recon__utils_8h.html#a9f4664a8c57cd234087fd70daf7ff7b0">psfr_calc</a> (<a class="el" href="maos_2types_8h.html#structsim__t">sim_t</a> *simu, <a class="el" href="type_8h.html#structdcell">dcell</a> *opdr, <a class="el" href="type_8h.html#structdcell">dcell</a> *dmpsol, <a class="el" href="type_8h.html#structdcell">dcell</a> *dmerr, <a class="el" href="type_8h.html#structdcell">dcell</a> *dmerr_lo)</td></tr>
<tr class="separator:a9f4664a8c57cd234087fd70daf7ff7b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a080bbb9fecf387ac6107766369a76aae"><td class="memItemLeft" align="right" valign="top"><a class="el" href="cn2est_8h.html#structcn2est__t">cn2est_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recon__utils_8h.html#a080bbb9fecf387ac6107766369a76aae">cn2est_prepare</a> (const <a class="el" href="parms_8h.html#structparms__t">parms_t</a> *parms, const <a class="el" href="maos_2types_8h.html#structpowfs__t">powfs_t</a> *powfs)</td></tr>
<tr class="separator:a080bbb9fecf387ac6107766369a76aae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74f945e450ef8677f831285a7fefce90"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recon__utils_8h.html#a74f945e450ef8677f831285a7fefce90">cn2est_isim</a> (<a class="el" href="type_8h.html#structdcell">dcell</a> *cn2res, <a class="el" href="maos_2types_8h.html#structrecon__t">recon_t</a> *recon, const <a class="el" href="parms_8h.html#structparms__t">parms_t</a> *parms, const <a class="el" href="type_8h.html#structdcell">dcell</a> *grad, int *tomo_update)</td></tr>
<tr class="separator:a74f945e450ef8677f831285a7fefce90"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Reusable utilities for wavefront reconstruction and DM fitting, supporting recon.c </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ab783a16cfb484ce0c36371e3161e1689"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab783a16cfb484ce0c36371e3161e1689">&#9670;&nbsp;</a></span>apply_L2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void apply_L2 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="type_8h.html#structdcell">dcell</a> **&#160;</td>
          <td class="paramname"><em>xout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="type_8h.html#structdspcell">dspcell</a> *&#160;</td>
          <td class="paramname"><em>L2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="type_8h.html#structdcell">dcell</a> *&#160;</td>
          <td class="paramname"><em>xin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>alpha</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Apply Laplacian2 to xin and accumulates to xout. </p>

</div>
</div>
<a id="abfaa311b9be11571120dff4f870dca5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abfaa311b9be11571120dff4f870dca5e">&#9670;&nbsp;</a></span>apply_invpsd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void apply_invpsd </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="type_8h.html#structdcell">dcell</a> **&#160;</td>
          <td class="paramname"><em>xout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="type_8h.html#structdcell">dcell</a> *&#160;</td>
          <td class="paramname"><em>xin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>xb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>yb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Apply turbulence invpsd to xin in Fourier space, scaled by alpha and add to xout. do nothing if xb != yb, since we apply to diagonal only. if xb==-1, do all blocks. </p><dl class="todo"><dt><b><a class="el" href="todo.html#_todo000010">Todo:</a></b></dt><dd>: this is not thread safe. </dd></dl>

</div>
</div>
<a id="a6a6ad264e91cb4ab88c057011ca80fd9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a6ad264e91cb4ab88c057011ca80fd9">&#9670;&nbsp;</a></span>apply_fractal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void apply_fractal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="type_8h.html#structdcell">dcell</a> **&#160;</td>
          <td class="paramname"><em>xout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="type_8h.html#structdcell">dcell</a> *&#160;</td>
          <td class="paramname"><em>xin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>xb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>yb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Apply fractal regularization to x, scaled by alpha. do nothing if xb != yb, since we apply to diagonal only. if xb==-1, do all blocks. </p><dl class="todo"><dt><b><a class="el" href="todo.html#_todo000011">Todo:</a></b></dt><dd>: this is not thread safe. </dd></dl>

</div>
</div>
<a id="aa2a1d9e1979e85bc3f9fc9fc7983101c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2a1d9e1979e85bc3f9fc9fc7983101c">&#9670;&nbsp;</a></span>remove_mode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void remove_mode </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="type_8h.html#structdcell">dcell</a> *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="type_8h.html#structdcell">dcell</a> *&#160;</td>
          <td class="paramname"><em>M</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="type_8h.html#structdcell">dcell</a> *&#160;</td>
          <td class="paramname"><em>PM</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove projection x = x - M * (PM * x) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td>The vector </td></tr>
    <tr><td class="paramname">M</td><td>The mode </td></tr>
    <tr><td class="paramname">PM</td><td>The mode projection matrix </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a29875eda5bf6485bb6b3b5628da3e361"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29875eda5bf6485bb6b3b5628da3e361">&#9670;&nbsp;</a></span>applyW()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void applyW </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="type_8h.html#structdcell">dcell</a> *&#160;</td>
          <td class="paramname"><em>xin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="type_8h.html#structdsp">dsp</a> *&#160;</td>
          <td class="paramname"><em>W0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdmat.html">dmat</a> *&#160;</td>
          <td class="paramname"><em>W1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real *&#160;</td>
          <td class="paramname"><em>wt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>apply weighting W0/W1 with weighting wt for each block. \(xin&lt;-(W0-W1*W1&#39;)*xin;\) </p>

</div>
</div>
<a id="ac2bca0565f72973497ae8d589a8be63d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2bca0565f72973497ae8d589a8be63d">&#9670;&nbsp;</a></span>calcWmcc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="type_8h.html#structdcell">dcell</a>* calcWmcc </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="type_8h.html#structdcell">dcell</a> *&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="type_8h.html#structdcell">dcell</a> *&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="type_8h.html#structdsp">dsp</a> *&#160;</td>
          <td class="paramname"><em>W0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdmat.html">dmat</a> *&#160;</td>
          <td class="paramname"><em>W1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdmat.html">dmat</a> *&#160;</td>
          <td class="paramname"><em>wt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute W0/W1 weighted dot product: \(A&#39;*(W0-W1*W1&#39;)*B\) </p>

</div>
</div>
<a id="a2f47ff139af79e1d954e29492a3f6436"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f47ff139af79e1d954e29492a3f6436">&#9670;&nbsp;</a></span>nea2sp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="type_8h.html#structdsp">dsp</a>* nea2sp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdmat.html">dmat</a> *&#160;</td>
          <td class="paramname"><em>nea</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ll</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ur</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ng</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Convert column vector nsax2 or nsax3 to sparse matrix. The third column of nea is coupling. ll: controls lower left ur: controls upper right if ng&gt;2, treat as diagonal matrix (for raw PWFS) </p>

</div>
</div>
<a id="a7574376a632a9ecd690f182327ece31a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7574376a632a9ecd690f182327ece31a">&#9670;&nbsp;</a></span>nea_chol()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void nea_chol </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdmat.html">dmat</a> **&#160;</td>
          <td class="paramname"><em>pout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdmat.html">dmat</a> *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ng</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Apply cholesky in a 2x2 symmetric matrix packed in [a[0,0],a[1,1],a[0,1]] as row vector. Input and output may be the same. if ng&gt;2, treat as diagonal matrix </p>

</div>
</div>
<a id="a30787abb7d5ba357803cabb24c2d26ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30787abb7d5ba357803cabb24c2d26ff">&#9670;&nbsp;</a></span>nea_inv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void nea_inv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdmat.html">dmat</a> **&#160;</td>
          <td class="paramname"><em>pout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdmat.html">dmat</a> *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>scale</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Apply matrix inversion in a 2x2 symmetrisa matrix packed in row vector [a[0,0],a[1,1],a[0,1]] Input and output may be the same. </p>

</div>
</div>
<a id="ad5e4f268e97c577eb4c5688ec0d595a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5e4f268e97c577eb4c5688ec0d595a0">&#9670;&nbsp;</a></span>nea_mm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void nea_mm </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdmat.html">dmat</a> **&#160;</td>
          <td class="paramname"><em>pout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdmat.html">dmat</a> *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ng</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Apply LL' to lower diagonal matrix packed in [a[0,0],a[1,1],a[0,1]] as row vector. Input and output may be the same. if ng&gt;2, treat as diagonal matrix </p>

</div>
</div>
<a id="af39118a3522ee175ace7951a59d82755"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af39118a3522ee175ace7951a59d82755">&#9670;&nbsp;</a></span>nea_check()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void nea_check </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdmat.html">dmat</a> *&#160;</td>
          <td class="paramname"><em>nea</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nsa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ng</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check the dimension of NEA and fix if possible </p>

</div>
</div>
<a id="a9f4664a8c57cd234087fd70daf7ff7b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f4664a8c57cd234087fd70daf7ff7b0">&#9670;&nbsp;</a></span>psfr_calc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void psfr_calc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="maos_2types_8h.html#structsim__t">sim_t</a> *&#160;</td>
          <td class="paramname"><em>simu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="type_8h.html#structdcell">dcell</a> *&#160;</td>
          <td class="paramname"><em>opdr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="type_8h.html#structdcell">dcell</a> *&#160;</td>
          <td class="paramname"><em>dmpsol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="type_8h.html#structdcell">dcell</a> *&#160;</td>
          <td class="paramname"><em>dmerr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="type_8h.html#structdcell">dcell</a> *&#160;</td>
          <td class="paramname"><em>dmerr_lo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute and save PSF reconstruction telemetry. For pseudo open loop estimations, like high order loop, we add opdr to, and subtract dmpsol from the OPD. For closed loop estimations, like ahst low order or lsr, we add dmerr_lo, and dmerr to the OPD. </p>

</div>
</div>
<a id="a080bbb9fecf387ac6107766369a76aae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a080bbb9fecf387ac6107766369a76aae">&#9670;&nbsp;</a></span>cn2est_prepare()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="cn2est_8h.html#structcn2est__t">cn2est_t</a>* cn2est_prepare </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="parms_8h.html#structparms__t">parms_t</a> *&#160;</td>
          <td class="paramname"><em>parms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="maos_2types_8h.html#structpowfs__t">powfs_t</a> *&#160;</td>
          <td class="paramname"><em>powfs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Prepare arrays for cn2 estimation. Multiple pairs can be used to do Cn2 Estimation. The result will be an average of them. </p>

</div>
</div>
<a id="a74f945e450ef8677f831285a7fefce90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74f945e450ef8677f831285a7fefce90">&#9670;&nbsp;</a></span>cn2est_isim()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cn2est_isim </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="type_8h.html#structdcell">dcell</a> *&#160;</td>
          <td class="paramname"><em>cn2res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="maos_2types_8h.html#structrecon__t">recon_t</a> *&#160;</td>
          <td class="paramname"><em>recon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="parms_8h.html#structparms__t">parms_t</a> *&#160;</td>
          <td class="paramname"><em>parms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="type_8h.html#structdcell">dcell</a> *&#160;</td>
          <td class="paramname"><em>grad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>tomo_update</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Wrapper of Cn2 Estimation operations in recon.c </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->

   </ul>
 </div>
</body>
</html>
