<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>MAOS: maos/recon_utils.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="maos.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">MAOS
   </div>
   <div id="projectbrief">Mulithreaded Adaptive Optics Simulator</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('recon__utils_8h.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">recon_utils.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;common.h&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab783a16cfb484ce0c36371e3161e1689"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recon__utils_8h.html#ab783a16cfb484ce0c36371e3161e1689">apply_L2</a> (<a class="el" href="structdcell.html">dcell</a> **xout, const <a class="el" href="structdspcell.html">dspcell</a> *L2, const <a class="el" href="structdcell.html">dcell</a> *xin, real alpha)</td></tr>
<tr class="separator:ab783a16cfb484ce0c36371e3161e1689"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abfaa311b9be11571120dff4f870dca5e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recon__utils_8h.html#abfaa311b9be11571120dff4f870dca5e">apply_invpsd</a> (<a class="el" href="structdcell.html">dcell</a> **xout, const void *extra, const <a class="el" href="structdcell.html">dcell</a> *xin, real alpha, int xb, int yb)</td></tr>
<tr class="separator:abfaa311b9be11571120dff4f870dca5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a6ad264e91cb4ab88c057011ca80fd9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recon__utils_8h.html#a6a6ad264e91cb4ab88c057011ca80fd9">apply_fractal</a> (<a class="el" href="structdcell.html">dcell</a> **xout, const void *extra, const <a class="el" href="structdcell.html">dcell</a> *xin, real alpha, int xb, int yb)</td></tr>
<tr class="separator:a6a6ad264e91cb4ab88c057011ca80fd9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08347b75d2ff1eb95c0a179873921e98"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recon__utils_8h.html#a08347b75d2ff1eb95c0a179873921e98">TTFR</a> (<a class="el" href="structdcell.html">dcell</a> *x, const <a class="el" href="structdcell.html">dcell</a> *TTF, const <a class="el" href="structdcell.html">dcell</a> *PTTF)</td></tr>
<tr class="separator:a08347b75d2ff1eb95c0a179873921e98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29875eda5bf6485bb6b3b5628da3e361"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recon__utils_8h.html#a29875eda5bf6485bb6b3b5628da3e361">applyW</a> (<a class="el" href="structdcell.html">dcell</a> *xin, const <a class="el" href="structdsp.html">dsp</a> *W0, const <a class="el" href="structdmat.html">dmat</a> *W1, const real *wt)</td></tr>
<tr class="separator:a29875eda5bf6485bb6b3b5628da3e361"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2bca0565f72973497ae8d589a8be63d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structdcell.html">dcell</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recon__utils_8h.html#ac2bca0565f72973497ae8d589a8be63d">calcWmcc</a> (const <a class="el" href="structdcell.html">dcell</a> *A, const <a class="el" href="structdcell.html">dcell</a> *B, const <a class="el" href="structdsp.html">dsp</a> *W0, const <a class="el" href="structdmat.html">dmat</a> *W1, const <a class="el" href="structdmat.html">dmat</a> *wt)</td></tr>
<tr class="separator:ac2bca0565f72973497ae8d589a8be63d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa04e0ea1c4aad353e807344b6e35f67"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recon__utils_8h.html#aaa04e0ea1c4aad353e807344b6e35f67">TomoR</a> (<a class="el" href="structdcell.html">dcell</a> **xout, const void *A, const <a class="el" href="structdcell.html">dcell</a> *xin, const real alpha)</td></tr>
<tr class="separator:aaa04e0ea1c4aad353e807344b6e35f67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a060ae9b2bc6a20378d32564512e04f2a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recon__utils_8h.html#a060ae9b2bc6a20378d32564512e04f2a">TomoRt</a> (<a class="el" href="structdcell.html">dcell</a> **gout, const void *A, const <a class="el" href="structdcell.html">dcell</a> *xin, const real alpha)</td></tr>
<tr class="separator:a060ae9b2bc6a20378d32564512e04f2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afcd22c411fbceae27ccf7e14309077f5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recon__utils_8h.html#afcd22c411fbceae27ccf7e14309077f5">TomoL</a> (<a class="el" href="structdcell.html">dcell</a> **xout, const void *A, const <a class="el" href="structdcell.html">dcell</a> *xin, const real alpha)</td></tr>
<tr class="separator:afcd22c411fbceae27ccf7e14309077f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a435a433b74e48db9983210dc8a4235ef"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recon__utils_8h.html#a435a433b74e48db9983210dc8a4235ef">FitL</a> (<a class="el" href="structdcell.html">dcell</a> **xout, const void *A, const <a class="el" href="structdcell.html">dcell</a> *xin, const real alpha)</td></tr>
<tr class="separator:a435a433b74e48db9983210dc8a4235ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29d19a65f0634a6fdf5a1e0ece0df03a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recon__utils_8h.html#a29d19a65f0634a6fdf5a1e0ece0df03a">FitR</a> (<a class="el" href="structdcell.html">dcell</a> **xout, const void *A, const <a class="el" href="structdcell.html">dcell</a> *xin, const real alpha)</td></tr>
<tr class="separator:a29d19a65f0634a6fdf5a1e0ece0df03a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8275bff1050a3bf784cbf75b0ed42092"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structdsp.html">dsp</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recon__utils_8h.html#a8275bff1050a3bf784cbf75b0ed42092">nea2sp</a> (<a class="el" href="structdmat.html">dmat</a> **nea, <a class="el" href="classlong.html">long</a> nsa)</td></tr>
<tr class="separator:a8275bff1050a3bf784cbf75b0ed42092"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a107d696093a361bb8d4d30b32b7ec6a7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recon__utils_8h.html#a107d696093a361bb8d4d30b32b7ec6a7">psfr_calc</a> (<a class="el" href="structSIM__T.html">SIM_T</a> *simu, <a class="el" href="structdcell.html">dcell</a> *opdr, <a class="el" href="structdcell.html">dcell</a> *dmpsol, <a class="el" href="structdcell.html">dcell</a> *dmerr, <a class="el" href="structdcell.html">dcell</a> *dmerr_lo)</td></tr>
<tr class="separator:a107d696093a361bb8d4d30b32b7ec6a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9cdd8da33de20c241e64bdf98cae94bf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recon__utils_8h.html#a9cdd8da33de20c241e64bdf98cae94bf">shift_grad</a> (<a class="el" href="structSIM__T.html">SIM_T</a> *simu)</td></tr>
<tr class="separator:a9cdd8da33de20c241e64bdf98cae94bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a069780ed16a2fa71439c5dbc9a95126b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structlmat.html">lmat</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recon__utils_8h.html#a069780ed16a2fa71439c5dbc9a95126b">loc_coord2ind</a> (<a class="el" href="structloc__t.html">loc_t</a> *aloc, const char *fndead)</td></tr>
<tr class="separator:a069780ed16a2fa71439c5dbc9a95126b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b4b56fd598b4714dd2d4247adc4c7e3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structcn2est__t.html">cn2est_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recon__utils_8h.html#a4b4b56fd598b4714dd2d4247adc4c7e3">cn2est_prepare</a> (const <a class="el" href="structPARMS__T.html">PARMS_T</a> *parms, const <a class="el" href="structPOWFS__T.html">POWFS_T</a> *powfs)</td></tr>
<tr class="separator:a4b4b56fd598b4714dd2d4247adc4c7e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8c45e746a307f96d7156cde74fe66dc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recon__utils_8h.html#ae8c45e746a307f96d7156cde74fe66dc">cn2est_isim</a> (<a class="el" href="structdcell.html">dcell</a> *cn2res, <a class="el" href="structRECON__T.html">RECON_T</a> *recon, const <a class="el" href="structPARMS__T.html">PARMS_T</a> *parms, const <a class="el" href="structdcell.html">dcell</a> *grad, int *tomo_update)</td></tr>
<tr class="separator:ae8c45e746a307f96d7156cde74fe66dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad707e69a8fa5604c71e5a2d0fadcfbb5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recon__utils_8h.html#ad707e69a8fa5604c71e5a2d0fadcfbb5">nea_chol</a> (<a class="el" href="structdmat.html">dmat</a> **pout, const <a class="el" href="structdmat.html">dmat</a> *in)</td></tr>
<tr class="separator:ad707e69a8fa5604c71e5a2d0fadcfbb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac585c2fa925a41f60b9bb757a9ef640b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recon__utils_8h.html#ac585c2fa925a41f60b9bb757a9ef640b">nea_inv</a> (<a class="el" href="structdmat.html">dmat</a> **pout, const <a class="el" href="structdmat.html">dmat</a> *in)</td></tr>
<tr class="separator:ac585c2fa925a41f60b9bb757a9ef640b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a182387c2aadfaac90464c33a249699ce"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recon__utils_8h.html#a182387c2aadfaac90464c33a249699ce">nea_mm</a> (<a class="el" href="structdmat.html">dmat</a> **pout, const <a class="el" href="structdmat.html">dmat</a> *in)</td></tr>
<tr class="separator:a182387c2aadfaac90464c33a249699ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae988b19359343246c5c05ffe6000caa0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recon__utils_8h.html#ae988b19359343246c5c05ffe6000caa0">check_nea</a> (<a class="el" href="structdmat.html">dmat</a> *nea, int nsa)</td></tr>
<tr class="separator:ae988b19359343246c5c05ffe6000caa0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="ab783a16cfb484ce0c36371e3161e1689"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab783a16cfb484ce0c36371e3161e1689">&#9670;&nbsp;</a></span>apply_L2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void apply_L2 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdcell.html">dcell</a> **&#160;</td>
          <td class="paramname"><em>xout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdspcell.html">dspcell</a> *&#160;</td>
          <td class="paramname"><em>L2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdcell.html">dcell</a> *&#160;</td>
          <td class="paramname"><em>xin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>alpha</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Reusable utilities for wavefront reconstruction and DM fitting. Apply Laplacian2 to xin and accumulates to xout. </p>

</div>
</div>
<a id="abfaa311b9be11571120dff4f870dca5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abfaa311b9be11571120dff4f870dca5e">&#9670;&nbsp;</a></span>apply_invpsd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void apply_invpsd </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdcell.html">dcell</a> **&#160;</td>
          <td class="paramname"><em>xout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdcell.html">dcell</a> *&#160;</td>
          <td class="paramname"><em>xin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>xb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>yb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Apply turbulence invpsd to xin in Fourier space, scaled by alpha and add to xout. do nothing if xb != yb, since we apply to diagonal only. if xb==-1, do all blocks. </p><dl class="todo"><dt><b><a class="el" href="todo.html#_todo000004">Todo:</a></b></dt><dd>: this is not thread safe. </dd></dl>

</div>
</div>
<a id="a6a6ad264e91cb4ab88c057011ca80fd9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a6ad264e91cb4ab88c057011ca80fd9">&#9670;&nbsp;</a></span>apply_fractal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void apply_fractal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdcell.html">dcell</a> **&#160;</td>
          <td class="paramname"><em>xout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdcell.html">dcell</a> *&#160;</td>
          <td class="paramname"><em>xin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>xb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>yb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Apply fractal regularization to x, scaled by alpha. do nothing if xb != yb, since we apply to diagonal only. if xb==-1, do all blocks. </p><dl class="todo"><dt><b><a class="el" href="todo.html#_todo000005">Todo:</a></b></dt><dd>: this is not thread safe. </dd></dl>

</div>
</div>
<a id="a08347b75d2ff1eb95c0a179873921e98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08347b75d2ff1eb95c0a179873921e98">&#9670;&nbsp;</a></span>TTFR()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TTFR </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdcell.html">dcell</a> *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdcell.html">dcell</a> *&#160;</td>
          <td class="paramname"><em>TTF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdcell.html">dcell</a> *&#160;</td>
          <td class="paramname"><em>PTTF</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Removing Tip/Tilt/Focus from LGS grads. TTF is the Tip/tilt/focus modes, and PTTF is the pseudo inverse of it, weighted by subaperture noise. It is not diagonal if differential focus is removed. So cannot be in Tomo_nea </p>

</div>
</div>
<a id="a29875eda5bf6485bb6b3b5628da3e361"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29875eda5bf6485bb6b3b5628da3e361">&#9670;&nbsp;</a></span>applyW()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void applyW </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdcell.html">dcell</a> *&#160;</td>
          <td class="paramname"><em>xin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdsp.html">dsp</a> *&#160;</td>
          <td class="paramname"><em>W0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdmat.html">dmat</a> *&#160;</td>
          <td class="paramname"><em>W1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real *&#160;</td>
          <td class="paramname"><em>wt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>apply weighting W0/W1 with weighting wt for each block. W0*xin-W1*(W1'*xin); </p>

</div>
</div>
<a id="ac2bca0565f72973497ae8d589a8be63d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2bca0565f72973497ae8d589a8be63d">&#9670;&nbsp;</a></span>calcWmcc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structdcell.html">dcell</a>* calcWmcc </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structdcell.html">dcell</a> *&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdcell.html">dcell</a> *&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdsp.html">dsp</a> *&#160;</td>
          <td class="paramname"><em>W0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdmat.html">dmat</a> *&#160;</td>
          <td class="paramname"><em>W1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdmat.html">dmat</a> *&#160;</td>
          <td class="paramname"><em>wt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute W0/W1 weighted dot product: <img class="formulaInl" alt="$A^T(W0 B-W1 (W1^T B))$" src="form_31.png"/> </p>

</div>
</div>
<a id="aaa04e0ea1c4aad353e807344b6e35f67"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa04e0ea1c4aad353e807344b6e35f67">&#9670;&nbsp;</a></span>TomoR()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TomoR </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdcell.html">dcell</a> **&#160;</td>
          <td class="paramname"><em>xout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdcell.html">dcell</a> *&#160;</td>
          <td class="paramname"><em>gin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real&#160;</td>
          <td class="paramname"><em>alpha</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Apply tomography right hand operator without using assembled matrix. Fast and saves memory. The operation is the same as the Tomo_nea and Tomo_iprop in TomoL, so merge the implemenations.</p>
<p>xout=HXW'<em>GP'*NEAI</em>(1-TTF*PTTF)*gin. </p>

</div>
</div>
<a id="a060ae9b2bc6a20378d32564512e04f2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a060ae9b2bc6a20378d32564512e04f2a">&#9670;&nbsp;</a></span>TomoRt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TomoRt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdcell.html">dcell</a> **&#160;</td>
          <td class="paramname"><em>gout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdcell.html">dcell</a> *&#160;</td>
          <td class="paramname"><em>xin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real&#160;</td>
          <td class="paramname"><em>alpha</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Transpose operation of TomoRt. From xout -&gt; gin </p>

</div>
</div>
<a id="afcd22c411fbceae27ccf7e14309077f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afcd22c411fbceae27ccf7e14309077f5">&#9670;&nbsp;</a></span>TomoL()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TomoL </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdcell.html">dcell</a> **&#160;</td>
          <td class="paramname"><em>xout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdcell.html">dcell</a> *&#160;</td>
          <td class="paramname"><em>xin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real&#160;</td>
          <td class="paramname"><em>alpha</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Apply tomography left hand side operator without using assembled matrix. Fast and saves memory. Only useful in CG. Accumulates to xout;</p>
<p>Some timing information: Generated in T410s with Intel Core i5 520 M @ 2.4 GHz (1 T is 1 thread, 2 T is 2 thread) and Poweredge with dual Xeon X5355 2.66Ghz (1 P is 1 thread, 8 P is 8 thread) Time 1 T 2 T 1 P 8 P HXW: 7.8 5.4 7.7 5.0 GP: 4.3 2.6 3.6 1.4 TTFR: 0.3 0.3 0.4 0.6 neai: 0.5 0.3 0.5 0.4 GP': 3.2 2.1 3.4 1.0 HXW': 5.5 4.7 7.4 4.9 cxx: 3.2 2.5 3.5 2.7 </p>

</div>
</div>
<a id="a435a433b74e48db9983210dc8a4235ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a435a433b74e48db9983210dc8a4235ef">&#9670;&nbsp;</a></span>FitL()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FitL </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdcell.html">dcell</a> **&#160;</td>
          <td class="paramname"><em>xout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdcell.html">dcell</a> *&#160;</td>
          <td class="paramname"><em>xin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real&#160;</td>
          <td class="paramname"><em>alpha</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Apply fit left hand side matrix in CG mode without using assembled matrix. Slow. don't use. Assembled matrix is faster because of multiple directions. </p>

</div>
</div>
<a id="a29d19a65f0634a6fdf5a1e0ece0df03a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29d19a65f0634a6fdf5a1e0ece0df03a">&#9670;&nbsp;</a></span>FitR()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FitR </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdcell.html">dcell</a> **&#160;</td>
          <td class="paramname"><em>xout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdcell.html">dcell</a> *&#160;</td>
          <td class="paramname"><em>xin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real&#160;</td>
          <td class="paramname"><em>alpha</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Apply fit right hand side matrix in CG mode without using assembled matrix. Slow. don't use. Assembled matrix is faster because of multiple directions. </p>

</div>
</div>
<a id="a8275bff1050a3bf784cbf75b0ed42092"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8275bff1050a3bf784cbf75b0ed42092">&#9670;&nbsp;</a></span>nea2sp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structdsp.html">dsp</a>* nea2sp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdmat.html">dmat</a> **&#160;</td>
          <td class="paramname"><em>nea</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlong.html">long</a>&#160;</td>
          <td class="paramname"><em>nsa</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Convert block of 2x2 neas to sparse matrix. </p>

</div>
</div>
<a id="a107d696093a361bb8d4d30b32b7ec6a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a107d696093a361bb8d4d30b32b7ec6a7">&#9670;&nbsp;</a></span>psfr_calc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void psfr_calc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSIM__T.html">SIM_T</a> *&#160;</td>
          <td class="paramname"><em>simu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdcell.html">dcell</a> *&#160;</td>
          <td class="paramname"><em>opdr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdcell.html">dcell</a> *&#160;</td>
          <td class="paramname"><em>dmpsol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdcell.html">dcell</a> *&#160;</td>
          <td class="paramname"><em>dmerr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdcell.html">dcell</a> *&#160;</td>
          <td class="paramname"><em>dmerr_lo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute and save PSF reconstruction telemetry. For pseudo open loop estimations, like high order loop, we add opdr to, and subtract dmpsol from the OPD. For closed loop estimations, like ahst low order or lsr, we add dmerr_lo, and dmerr to the OPD. </p>

</div>
</div>
<a id="a9cdd8da33de20c241e64bdf98cae94bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9cdd8da33de20c241e64bdf98cae94bf">&#9670;&nbsp;</a></span>shift_grad()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void shift_grad </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSIM__T.html">SIM_T</a> *&#160;</td>
          <td class="paramname"><em>simu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Shift gradient when new gradients are ready (in the end of parallel section in sim in CL or wfsgrad in OL). Do not execute in parallel with other routines. In GLAO mode, also averaged gradients from the same type of powfs. </p>

</div>
</div>
<a id="a069780ed16a2fa71439c5dbc9a95126b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a069780ed16a2fa71439c5dbc9a95126b">&#9670;&nbsp;</a></span>loc_coord2ind()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structlmat.html">lmat</a>* loc_coord2ind </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structloc__t.html">loc_t</a> *&#160;</td>
          <td class="paramname"><em>aloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fndead</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Parse the input dead actuator location to actuator indices based on aloc. 2015-03-30: build a mask for dead actuators based on coordinate. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">aloc</td><td>Aloc </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fndead</td><td>File containing dead actuators </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a4b4b56fd598b4714dd2d4247adc4c7e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b4b56fd598b4714dd2d4247adc4c7e3">&#9670;&nbsp;</a></span>cn2est_prepare()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structcn2est__t.html">cn2est_t</a>* cn2est_prepare </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structPARMS__T.html">PARMS_T</a> *&#160;</td>
          <td class="paramname"><em>parms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structPOWFS__T.html">POWFS_T</a> *&#160;</td>
          <td class="paramname"><em>powfs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Prepare arrays for cn2 estimation. Multiple pairs can be used to do Cn2 Estimation. The result will be an average of them. </p>

</div>
</div>
<a id="ae8c45e746a307f96d7156cde74fe66dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8c45e746a307f96d7156cde74fe66dc">&#9670;&nbsp;</a></span>cn2est_isim()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cn2est_isim </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdcell.html">dcell</a> *&#160;</td>
          <td class="paramname"><em>cn2res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structRECON__T.html">RECON_T</a> *&#160;</td>
          <td class="paramname"><em>recon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structPARMS__T.html">PARMS_T</a> *&#160;</td>
          <td class="paramname"><em>parms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdcell.html">dcell</a> *&#160;</td>
          <td class="paramname"><em>grad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>tomo_update</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Wrapper of Cn2 Estimation operations in recon.c </p>

</div>
</div>
<a id="ad707e69a8fa5604c71e5a2d0fadcfbb5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad707e69a8fa5604c71e5a2d0fadcfbb5">&#9670;&nbsp;</a></span>nea_chol()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void nea_chol </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdmat.html">dmat</a> **&#160;</td>
          <td class="paramname"><em>pout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdmat.html">dmat</a> *&#160;</td>
          <td class="paramname"><em>in</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Apply cholesky in a 2x2 symmetric matrix packed in [a[0,0],a[1,1],a[0,1]] as row vector. Input and output may be the same. </p>

</div>
</div>
<a id="ac585c2fa925a41f60b9bb757a9ef640b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac585c2fa925a41f60b9bb757a9ef640b">&#9670;&nbsp;</a></span>nea_inv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void nea_inv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdmat.html">dmat</a> **&#160;</td>
          <td class="paramname"><em>pout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdmat.html">dmat</a> *&#160;</td>
          <td class="paramname"><em>in</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Apply matrix inversion in a 2x2 symmetrisa matrix packed in [a[0,0],a[1,1],a[0,1]] as row vector. Input and output may be the same. </p>

</div>
</div>
<a id="a182387c2aadfaac90464c33a249699ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a182387c2aadfaac90464c33a249699ce">&#9670;&nbsp;</a></span>nea_mm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void nea_mm </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdmat.html">dmat</a> **&#160;</td>
          <td class="paramname"><em>pout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdmat.html">dmat</a> *&#160;</td>
          <td class="paramname"><em>in</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Apply LL' to lower diagonal matrix packed in [a[0,0],a[1,1],a[0,1]] as row vector. Input and output may be the same. </p>

</div>
</div>
<a id="ae988b19359343246c5c05ffe6000caa0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae988b19359343246c5c05ffe6000caa0">&#9670;&nbsp;</a></span>check_nea()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void check_nea </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdmat.html">dmat</a> *&#160;</td>
          <td class="paramname"><em>nea</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nsa</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check the dimension of NEA and fix if possible </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->

   </ul>
 </div>
</body>
</html>
