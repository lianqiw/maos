<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>MAOS: lib/zernike.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="maos.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">MAOS
   </div>
   <div id="projectbrief">Multithreaded Adaptive Optics Simulator</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('zernike_8h.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">zernike.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="mathdef_8h.html">../math/mathdef.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a5d9a80af0c9899a97dac3e7c231e5f5e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="type_8h.html#structdmat">dmat</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zernike_8h.html#a5d9a80af0c9899a97dac3e7c231e5f5e">zernike_Rnm</a> (const <a class="el" href="type_8h.html#structdmat">dmat</a> *locr, int ir, int im)</td></tr>
<tr class="separator:a5d9a80af0c9899a97dac3e7c231e5f5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30976931ca973717cf8c48ba8689cb81"><td class="memItemLeft" align="right" valign="top"><a class="el" href="type_8h.html#structdmat">dmat</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zernike_8h.html#a30976931ca973717cf8c48ba8689cb81">zernike</a> (const <a class="el" href="type_8h.html#structloc__t">loc_t</a> *loc, real D, int rstart, int rend, int flag)</td></tr>
<tr class="separator:a30976931ca973717cf8c48ba8689cb81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1ffbd181e4b0dd153cf914d4b3b1b55"><td class="memItemLeft" align="right" valign="top"><a class="el" href="type_8h.html#structdmat">dmat</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zernike_8h.html#ae1ffbd181e4b0dd153cf914d4b3b1b55">zernike_cov_kolmogorov</a> (int nr)</td></tr>
<tr class="separator:ae1ffbd181e4b0dd153cf914d4b3b1b55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a87a1458eb7145b8ef9feeddf73ecc0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="type_8h.html#structdmat">dmat</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zernike_8h.html#a5a87a1458eb7145b8ef9feeddf73ecc0">cov_vonkarman</a> (const <a class="el" href="type_8h.html#structloc__t">loc_t</a> *loc, const <a class="el" href="type_8h.html#structdmat">dmat</a> *modz, real L0)</td></tr>
<tr class="separator:a5a87a1458eb7145b8ef9feeddf73ecc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55fe77ae189bec1320fa971b9aba6878"><td class="memItemLeft" align="right" valign="top"><a class="el" href="type_8h.html#structdmat">dmat</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zernike_8h.html#a55fe77ae189bec1320fa971b9aba6878">cov_diagnolize</a> (const <a class="el" href="type_8h.html#structdmat">dmat</a> *mz, const <a class="el" href="type_8h.html#structdmat">dmat</a> *cov)</td></tr>
<tr class="separator:a55fe77ae189bec1320fa971b9aba6878"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb04c002144cdfcb3f8762ef7629b494"><td class="memItemLeft" align="right" valign="top"><a class="el" href="type_8h.html#structdmat">dmat</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zernike_8h.html#acb04c002144cdfcb3f8762ef7629b494">KL_vonkarman</a> (const <a class="el" href="type_8h.html#structloc__t">loc_t</a> *loc, int nmod, real L0)</td></tr>
<tr class="separator:acb04c002144cdfcb3f8762ef7629b494"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18115969f0ee8249823fb1fc14bcb24c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="type_8h.html#structdmat">dmat</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zernike_8h.html#a18115969f0ee8249823fb1fc14bcb24c">fft_mode</a> (const <a class="el" href="type_8h.html#structloc__t">loc_t</a> *loc, real D, real px, real py)</td></tr>
<tr class="separator:a18115969f0ee8249823fb1fc14bcb24c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a5d9a80af0c9899a97dac3e7c231e5f5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d9a80af0c9899a97dac3e7c231e5f5e">&#9670;&nbsp;</a></span>zernike_Rnm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="type_8h.html#structdmat">dmat</a>* zernike_Rnm </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="type_8h.html#structdmat">dmat</a> *&#160;</td>
          <td class="paramname"><em>locr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>im</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Generating Zernike Rnm for radial order ir, azimuthal or im. used by loc_zernike. </p>

</div>
</div>
<a id="a30976931ca973717cf8c48ba8689cb81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30976931ca973717cf8c48ba8689cb81">&#9670;&nbsp;</a></span>zernike()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="type_8h.html#structdmat">dmat</a>* zernike </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="type_8h.html#structloc__t">loc_t</a> *&#160;</td>
          <td class="paramname"><em>loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>D</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>rmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>rmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create Zernike modes on loc with diameter D and radial order from rmin to rmax r=0 is piston r=1 is tip/tilt r=2 is quadratic modes if nopiston is set, skip piston mode. if flag is &gt;0, only radial mode is used. if flag is 0, all modes between rmin and rmax. if flag is &lt;0, only generate mode -flag. rmin and rmax is irrelevant </p>

</div>
</div>
<a id="ae1ffbd181e4b0dd153cf914d4b3b1b55"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1ffbd181e4b0dd153cf914d4b3b1b55">&#9670;&nbsp;</a></span>zernike_cov_kolmogorov()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="type_8h.html#structdmat">dmat</a>* zernike_cov_kolmogorov </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Covariance of zernike modes in Kolmogorov Turbulence. Only modes with the same m have non-zero covariance.</p>
<p>Based on Eq 3.14 in Adaptive Optics in Astronomy (Roddier 1999). Verified against values in J.Y.Wang 1978, table II(a,b).</p>
<p>Notice that (D/r0)^(5/3) has been factored out.</p>
<p>2015-06-05: This is not longer being used. It is inaccurate for annular pupil. Analytic calculation using the power spectrum is used instead. </p>

</div>
</div>
<a id="a5a87a1458eb7145b8ef9feeddf73ecc0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a87a1458eb7145b8ef9feeddf73ecc0">&#9670;&nbsp;</a></span>cov_vonkarman()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="type_8h.html#structdmat">dmat</a>* cov_vonkarman </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="type_8h.html#structloc__t">loc_t</a> *&#160;</td>
          <td class="paramname"><em>loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="type_8h.html#structdmat">dmat</a> *&#160;</td>
          <td class="paramname"><em>modz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>L0</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute covariance matrix of zernike modes in von Karman turbulence </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">loc</td><td>The location grid </td></tr>
    <tr><td class="paramname">modz</td><td>Zernike modes </td></tr>
    <tr><td class="paramname">L0</td><td>Outer scale </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a55fe77ae189bec1320fa971b9aba6878"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55fe77ae189bec1320fa971b9aba6878">&#9670;&nbsp;</a></span>cov_diagnolize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="type_8h.html#structdmat">dmat</a>* cov_diagnolize </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="type_8h.html#structdmat">dmat</a> *&#160;</td>
          <td class="paramname"><em>mod</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="type_8h.html#structdmat">dmat</a> *&#160;</td>
          <td class="paramname"><em>cov</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Diagnolize the covariance matrix and transform the mode. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mod</td><td>Input mode </td></tr>
    <tr><td class="paramname">cov</td><td>Covariance of modes </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="acb04c002144cdfcb3f8762ef7629b494"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb04c002144cdfcb3f8762ef7629b494">&#9670;&nbsp;</a></span>KL_vonkarman()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="type_8h.html#structdmat">dmat</a>* KL_vonkarman </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="type_8h.html#structloc__t">loc_t</a> *&#160;</td>
          <td class="paramname"><em>loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nmod</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>L0</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create Karhunen-Loeve modes for which each mode is statistically independent in von Karman spectrum.</p>
<p>The original method is to compute covariance of zernike modes in von Karman spectrum and diagnolize the covariance matrix. But this methods suffers for higher order systems because high order zernike modes are hard to generate on account of limited resolution of real precision floating point numbers. To make matters worse, to generate m KL modes, around 2*m Zernike modes are needed because each KL mode is a linear combination of all Zernike modes with same azimuthal (m) but higher radial (r) order. A work around of the precisiosn issue is to limit the absolute value of the zernike modes to within 100 to avoid excessive norm due to round off errors.</p>
<p>The new method is to use zonal modes (identity matrix). The advantage is that the zonal modes spans the whole range of possible modes and are straightforward to generate.</p>
<p>In theory, the KL modes computes should be independent on the starting mode, as long as the modes span the whole vector space for the coordinate. </p>

</div>
</div>
<a id="a18115969f0ee8249823fb1fc14bcb24c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18115969f0ee8249823fb1fc14bcb24c">&#9670;&nbsp;</a></span>fft_mode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="type_8h.html#structdmat">dmat</a>* fft_mode </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="type_8h.html#structloc__t">loc_t</a> *&#160;</td>
          <td class="paramname"><em>loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>D</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>px</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>py</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Generate FFT mode with period. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->

   </ul>
 </div>
</body>
</html>
