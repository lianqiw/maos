<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>MAOS: lib/turbulence.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="maos.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">MAOS
   </div>
   <div id="projectbrief">Multithreaded Adaptive Optics Simulator</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('turbulence_8h.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">turbulence.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="mathdef_8h.html">../math/mathdef.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:structgenatm__t"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="turbulence_8h.html#structgenatm__t">genatm_t</a></td></tr>
<tr class="separator:structgenatm__t"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:addf46c2b6461f8cd3045493cb2422b90"><td class="memItemLeft" align="right" valign="top"><a class="el" href="type_8h.html#structmap__t">map_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="turbulence_8h.html#addf46c2b6461f8cd3045493cb2422b90">genatm_simple</a> (real r0, real L0, real dx, <a class="el" href="classlong.html">long</a> nx)</td></tr>
<tr class="separator:addf46c2b6461f8cd3045493cb2422b90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d2df4e268244fbc0f8ea206aa7a5b51"><td class="memItemLeft" align="right" valign="top"><a class="el" href="type_8h.html#structdmat">dmat</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="turbulence_8h.html#a6d2df4e268244fbc0f8ea206aa7a5b51">genatm_loc</a> (<a class="el" href="type_8h.html#structloc__t">loc_t</a> *loc, real r0, real L0)</td></tr>
<tr class="separator:a6d2df4e268244fbc0f8ea206aa7a5b51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a6a9578e6bd96e6a6ea0b7285cf3587"><td class="memItemLeft" align="right" valign="top"><a class="el" href="type_8h.html#structmapcell">mapcell</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="turbulence_8h.html#a0a6a9578e6bd96e6a6ea0b7285cf3587">genscreen</a> (<a class="el" href="turbulence_8h.html#structgenatm__t">genatm_t</a> *data)</td></tr>
<tr class="separator:a0a6a9578e6bd96e6a6ea0b7285cf3587"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e3606e0e0ac7eedc0ed98b865c4b9c4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="type_8h.html#structmapcell">mapcell</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="turbulence_8h.html#a5e3606e0e0ac7eedc0ed98b865c4b9c4">genscreen_str</a> (const char *header)</td></tr>
<tr class="separator:a5e3606e0e0ac7eedc0ed98b865c4b9c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a355ca2e7672a29cbefea042caba47c47"><td class="memItemLeft" align="right" valign="top"><a class="el" href="type_8h.html#structdmat">dmat</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="turbulence_8h.html#a355ca2e7672a29cbefea042caba47c47">turbcov</a> (<a class="el" href="type_8h.html#structdmat">dmat</a> *r, real rmax, real r0, real L0)</td></tr>
<tr class="separator:a355ca2e7672a29cbefea042caba47c47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a003ba466f6608495ae22890661663e8e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="turbulence_8h.html#a003ba466f6608495ae22890661663e8e">spatial_psd</a> (<a class="el" href="type_8h.html#structdmat">dmat</a> **out, <a class="el" href="classlong.html">long</a> nx, <a class="el" href="classlong.html">long</a> ny, real dx, real strength, real L0, real fmin, real fmax, real slope, real power)</td></tr>
<tr class="separator:a003ba466f6608495ae22890661663e8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ac871dc0baf2241c719fa67f892f292"><td class="memItemLeft" align="right" valign="top"><a class="el" href="type_8h.html#structdmat">dmat</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="turbulence_8h.html#a5ac871dc0baf2241c719fa67f892f292">turbpsd</a> (<a class="el" href="classlong.html">long</a> nx, <a class="el" href="classlong.html">long</a> ny, real dx, real r0, real L0, real slope, real power)</td></tr>
<tr class="separator:a5ac871dc0baf2241c719fa67f892f292"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24f1950319bbbf2a5537b853bdb3b879"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="turbulence_8h.html#a24f1950319bbbf2a5537b853bdb3b879">calc_aniso</a> (real r0, int nht, real *ht, real *wt)</td></tr>
<tr class="separator:a24f1950319bbbf2a5537b853bdb3b879"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44a7c973125f67a96ac67f93fe400e5d"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="turbulence_8h.html#a44a7c973125f67a96ac67f93fe400e5d">calc_greenwood</a> (real r0, int nps, real *ws, real *wt)</td></tr>
<tr class="separator:a44a7c973125f67a96ac67f93fe400e5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af56dc39765ac225d9183cccfa7583a02"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="turbulence_8h.html#af56dc39765ac225d9183cccfa7583a02">calc_aniso2</a> (real r0, int nht, real *ht, real *wt, real hc1, real hc2)</td></tr>
<tr class="separator:af56dc39765ac225d9183cccfa7583a02"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Contains routines to generate atmospheric turbulence screens </p>
</div><hr/><h2 class="groupheader">Data Structure Documentation</h2>
<a name="structgenatm__t" id="structgenatm__t"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structgenatm__t">&#9670;&nbsp;</a></span>genatm_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct genatm_t</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"></div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a06bae77b23497a10e8a04568bc702dc4"></a><a class="el" href="structmt__state.html">rand_t</a> *</td>
<td class="fieldname">
rstat</td>
<td class="fielddoc">
<p>The random stream </p>
</td></tr>
<tr><td class="fieldtype">
<a id="ab8e92c7c3f984575ccb12a9bc53b3f8a"></a>real *</td>
<td class="fieldname">
wt</td>
<td class="fielddoc">
<p>The layer weights </p>
</td></tr>
<tr><td class="fieldtype">
<a id="ab7b25fe17d4339073cad47008f1039f1"></a>real</td>
<td class="fieldname">
r0</td>
<td class="fielddoc">
<p>The Fried Parameter </p>
</td></tr>
<tr><td class="fieldtype">
<a id="aa9b4ca24f0fd945b75641b08a2bc0ef6"></a>real *</td>
<td class="fieldname">
L0</td>
<td class="fielddoc">
<p>The outer scale </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a0de37cc1e32b22a7fa492baeea9491f6"></a>real</td>
<td class="fieldname">
dx</td>
<td class="fielddoc">
<p>The sampling </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a26e407bbe79a436d7dd748019379c55d"></a>real</td>
<td class="fieldname">
fmin</td>
<td class="fielddoc">
<p>Minimum spatial frequency </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a457b83dce016da4add3e62cfc7325944"></a>real</td>
<td class="fieldname">
fmax</td>
<td class="fielddoc">
<p>Maximum spatial frequency </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a02c9b62d37fd61caf13f528c73d88f54"></a>real</td>
<td class="fieldname">
slope</td>
<td class="fielddoc">
<p>Power slope of PSD. -11/3 for Von Karman, -4 for Biharmonic. -1 for fractal. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a40f307194dd03f4db18cf1ae1c9d6bf0"></a><a class="el" href="classlong.html">long</a></td>
<td class="fieldname">
nx</td>
<td class="fielddoc">
<p>Number of pixels along x </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a7d5004ae49945076681b6932f7a6a795"></a><a class="el" href="classlong.html">long</a></td>
<td class="fieldname">
ny</td>
<td class="fielddoc">
<p>Number of pixels along y </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a79dcdeffe885de690d08fad6c5d18fda"></a><a class="el" href="classlong.html">long</a></td>
<td class="fieldname">
nlayer</td>
<td class="fielddoc">
<p>The number of layers </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a940384dfed98d31fa25c54714226be96"></a><a class="el" href="classlong.html">long</a></td>
<td class="fieldname">
ninit</td>
<td class="fielddoc">
<p>In Fractal method, the size of initial screen </p>
</td></tr>
<tr><td class="fieldtype">
<a id="af80a72e15ce13450ea40e802e029cde7"></a><a class="el" href="classlong.html">long</a></td>
<td class="fieldname">
share</td>
<td class="fielddoc">
<p>Use file backend for sharing of atmosphere </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a2205340b3ee4c50696fb19e78dfbe16a"></a><a class="el" href="type_8h.html#structdmat">dmat</a> *</td>
<td class="fieldname">
r0logpsds</td>
<td class="fielddoc">
<p>Spatial PSD of log(r0) (m)=beta*f^alpha. [alpha, beta, minfreq, maxfreq] </p>
</td></tr>
<tr><td class="fieldtype">
<a id="ae6ab6609cc4b8fa90c08562e818f590d"></a><a class="el" href="type_8h.html#structmapcell">mapcell</a> *</td>
<td class="fieldname">
screen</td>
<td class="fielddoc">
<p>The destination screen pointer </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="addf46c2b6461f8cd3045493cb2422b90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#addf46c2b6461f8cd3045493cb2422b90">&#9670;&nbsp;</a></span>genatm_simple()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="type_8h.html#structmap__t">map_t</a>* genatm_simple </td>
          <td>(</td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>r0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>L0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlong.html">long</a>&#160;</td>
          <td class="paramname"><em>nx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>A simpler interface to gerate a single screen. </p>

</div>
</div>
<a id="a6d2df4e268244fbc0f8ea206aa7a5b51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d2df4e268244fbc0f8ea206aa7a5b51">&#9670;&nbsp;</a></span>genatm_loc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="type_8h.html#structdmat">dmat</a>* genatm_loc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="type_8h.html#structloc__t">loc_t</a> *&#160;</td>
          <td class="paramname"><em>loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>r0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>dsa</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Generate atmosphere and map onto loc. </p>

</div>
</div>
<a id="a0a6a9578e6bd96e6a6ea0b7285cf3587"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a6a9578e6bd96e6a6ea0b7285cf3587">&#9670;&nbsp;</a></span>genscreen()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="type_8h.html#structmapcell">mapcell</a>* genscreen </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="turbulence_8h.html#structgenatm__t">genatm_t</a> *&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Generates multiple screens from spectrum. Note that if data-&gt;share=1, the atmosphere will be different from data-&gt;share=0 due to different algorithms used. </p>

</div>
</div>
<a id="a5e3606e0e0ac7eedc0ed98b865c4b9c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e3606e0e0ac7eedc0ed98b865c4b9c4">&#9670;&nbsp;</a></span>genscreen_str()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="type_8h.html#structmapcell">mapcell</a>* genscreen_str </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>header</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Generate screen according to a header. It has three possible options. 1) load from file 2) generate screen from PSD with the following keys r0 L0 dx slope nx seed 3) generate from a zernike mode with given RMS (in nm) and mode. </p>

</div>
</div>
<a id="a355ca2e7672a29cbefea042caba47c47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a355ca2e7672a29cbefea042caba47c47">&#9670;&nbsp;</a></span>turbcov()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="type_8h.html#structdmat">dmat</a>* turbcov </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="type_8h.html#structdmat">dmat</a> *&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>rmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>r0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>L0</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute the covariance for separation of r, and put the values in cov. In kolmogorov spectrum, the variance are defined as half of the structure function between two points separated by rmax. </p>

</div>
</div>
<a id="a003ba466f6608495ae22890661663e8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a003ba466f6608495ae22890661663e8e">&#9670;&nbsp;</a></span>spatial_psd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void spatial_psd </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="type_8h.html#structdmat">dmat</a> **&#160;</td>
          <td class="paramname"><em>pout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlong.html">long</a>&#160;</td>
          <td class="paramname"><em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlong.html">long</a>&#160;</td>
          <td class="paramname"><em>ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>strength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>outerscale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>minfreq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>maxfreq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>slope</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>power</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates 2-d PSD at size nx*ny: psd=(strength*(f^2+L0^-2)^(slope/2))^power. Zero frequency component is in the corner <a class="el" href="type_8h.html#afba9f40fe63e258302b2c472f9e9f386">P(psd,0)</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pout</td><td>Output </td></tr>
    <tr><td class="paramname">nx</td><td>The size </td></tr>
    <tr><td class="paramname">ny</td><td>The size </td></tr>
    <tr><td class="paramname">dx</td><td>The sampling of spatial coordinate. </td></tr>
    <tr><td class="paramname">strength</td><td>Strength coefficient </td></tr>
    <tr><td class="paramname">outerscale</td><td>Outerscale </td></tr>
    <tr><td class="paramname">minfreq</td><td>Low end frequency cut off </td></tr>
    <tr><td class="paramname">maxfreq</td><td>High end frequency cut off </td></tr>
    <tr><td class="paramname">slope</td><td>should be -11/3 for von karman or kolmogorov screens, or -4 for biharmonic screen (just testing only). </td></tr>
    <tr><td class="paramname">power</td><td>optionally do a power of psd. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a5ac871dc0baf2241c719fa67f892f292"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ac871dc0baf2241c719fa67f892f292">&#9670;&nbsp;</a></span>turbpsd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="type_8h.html#structdmat">dmat</a>* turbpsd </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlong.html">long</a>&#160;</td>
          <td class="paramname"><em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlong.html">long</a>&#160;</td>
          <td class="paramname"><em>ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>r0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>L0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>slope</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>power</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute spatial PSD of turbulence spectrum. </p>

</div>
</div>
<a id="a24f1950319bbbf2a5537b853bdb3b879"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a24f1950319bbbf2a5537b853bdb3b879">&#9670;&nbsp;</a></span>calc_aniso()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real calc_aniso </td>
          <td>(</td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>r0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real *&#160;</td>
          <td class="paramname"><em>ht</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real *&#160;</td>
          <td class="paramname"><em>wt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Estimate anisoplanatic angle theta0 from Fried parameter r0, layer height and weights. </p>

</div>
</div>
<a id="a44a7c973125f67a96ac67f93fe400e5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44a7c973125f67a96ac67f93fe400e5d">&#9670;&nbsp;</a></span>calc_greenwood()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real calc_greenwood </td>
          <td>(</td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>r0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real *&#160;</td>
          <td class="paramname"><em>ws</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real *&#160;</td>
          <td class="paramname"><em>wt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Estimate Green wood frequency </p>

</div>
</div>
<a id="af56dc39765ac225d9183cccfa7583a02"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af56dc39765ac225d9183cccfa7583a02">&#9670;&nbsp;</a></span>calc_aniso2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real calc_aniso2 </td>
          <td>(</td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>r0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real *&#160;</td>
          <td class="paramname"><em>ht</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real *&#160;</td>
          <td class="paramname"><em>wt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>hc1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>hc2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Estimate generalized aniso angle theta2 from Fried parameter r0, and layer height and weights, and deformable mirror conjugation heights hc1 hc2 of the ground and altitude DMs. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->

   </ul>
 </div>
</body>
</html>
